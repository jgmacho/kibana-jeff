"use strict";
/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License;
 * you may not use this file except in compliance with the Elastic License.
 */
Object.defineProperty(exports, "__esModule", { value: true });
const memory_beats_adapter_1 = require("../adapters/beats/memory_beats_adapter");
const memory_tags_adapter_1 = require("../adapters/tags/memory_tags_adapter");
const memory_tokens_adapter_1 = require("../adapters/tokens/memory_tokens_adapter");
const hapi_framework_adapter_1 = require("../adapters/framework/hapi_framework_adapter");
const beats_1 = require("../domains/beats");
const tags_1 = require("../domains/tags");
const tokens_1 = require("../domains/tokens");
function compose(server) {
    const framework = new hapi_framework_adapter_1.HapiBackendFrameworkAdapter(undefined, server);
    const tags = new tags_1.CMTagsDomain(new memory_tags_adapter_1.MemoryTagsAdapter(server.tagsDB || []));
    const tokens = new tokens_1.CMTokensDomain(new memory_tokens_adapter_1.MemoryTokensAdapter(server.tokensDB || []), {
        framework,
    });
    const beats = new beats_1.CMBeatsDomain(new memory_beats_adapter_1.MemoryBeatsAdapter(server.beatsDB || []), {
        tags,
        tokens,
        framework,
    });
    const domainLibs = {
        beats,
        tags,
        tokens,
    };
    const libs = {
        framework,
        ...domainLibs,
    };
    return libs;
}
exports.compose = compose;
